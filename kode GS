function doGet(e) {
  return handleRequest(e);
}

function handleRequest(e) {
  try {
    // Get parameters from URL
    var params = e.parameter;
    
    // Log received data
    console.log('Received data:', params);
    
    // Save to spreadsheet
    var ss = SpreadsheetApp.openById("1NxbbS6x4_6O8j0E8VnYMoxc8Cjxh0DMjh2z2WsxFFaw");
    var sheet = ss.getSheetByName("Sheet1");
    
    var rowData = [
      new Date(),
      params.nama || "",
      params.npp || "",
      params.divisi || "",
      params.region || "",
      params.cou || "",
      params.jabatan || "",
      params.jawaban1 || "",
      params.jawaban2 || "",
      params.jawaban3 || "",
      params.jawaban4 || "",
      params.jawaban5 || "",
      params.jawaban6 || "",
      params.jawaban7 || "",
      params.jawaban8 || ""
    ];
    
    sheet.appendRow(rowData);
    
    // Return simple success response
    return ContentService.createTextOutput("SUCCESS: Data saved to row " + sheet.getLastRow())
      .setMimeType(ContentService.MimeType.TEXT);
      
  } catch (error) {
    console.error('Error:', error);
    return ContentService.createTextOutput("ERROR: " + error.toString())
      .setMimeType(ContentService.MimeType.TEXT);
  }
}

// Test function
function testDoGet() {
  var mockData = {
    parameter: {
      nama: "Test User",
      npp: "12345",
      divisi: "HCC",
      region: "Region 1",
      jabatan: "Staf",
      jawaban1: "Test jawaban 1",
      jawaban2: "Test jawaban 2"
    }
  };
  
  var result = handleRequest(mockData);
  Logger.log(result.getContent());
  return result.getContent();
}
